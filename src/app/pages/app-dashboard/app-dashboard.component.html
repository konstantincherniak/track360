<div class="dashboard-container">
  <mat-toolbar color="primary">
    <span>Session Tracker</span>
    <span class="spacer"></span>
    <span class="user-email">{{ userEmail() }}</span>
    <button mat-icon-button (click)="signOut()" matTooltip="Sign Out">
      <mat-icon>logout</mat-icon>
    </button>
  </mat-toolbar>

  <main class="dashboard-content">
    <app-tabs-summary
      [onlineCount]="onlineCount()"
      [totalCount]="totalCount()"
      [deviceCount]="deviceCount()"
    />

    <h2 class="section-title">
      <mat-icon>devices</mat-icon>
      Your Sessions
    </h2>

    @if (isLoading() && tabsByDevice().length === 0) {
      <div class="loading-container">
        <mat-spinner diameter="40"></mat-spinner>
        <span>Loading sessions...</span>
      </div>
    } @else if (tabsByDevice().length === 0) {
      <div class="empty-state">
        <mat-icon>info_outline</mat-icon>
        <p>No active sessions found</p>
      </div>
    } @else {
      <div class="device-groups">
        @for (group of tabsByDevice(); track group.deviceId) {
          <app-device-group [group]="group" />
        }
      </div>
    }
  </main>
</div>
